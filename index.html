<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minha Loja - Vitrine</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="animations.css">
    <link rel="stylesheet" href="header-responsive.css">
    <link rel="stylesheet" href="cart-modal.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
      <script type="module" src="firebase-config.js"></script>
  <script type="module" src="auth-manager.js"></script>
  <script type="module" src="script.js"></script>
    <script type="module" src="auth-manager.js"></script>
    <script type="module" src="product-manager.js"></script>
</head>
<body>
  <header>
    <div class="header-content">
      <div class="logo-section">
        <h1 onclick="showSection('inicio')">Minha Loja</h1>
      </div>
      
      <nav class="nav-bar">
        <a href="#inicio" onclick="showSection('inicio'); setActiveLink(this)" class="nav-link active">
          <i class="fas fa-home"></i> Home
        </a>
        <a href="#produtos" onclick="showSection('produtos'); setActiveLink(this)" class="nav-link">
          <i class="fas fa-shopping-bag"></i> Produtos
        </a>
        <a href="#sobre" onclick="showSection('sobre'); setActiveLink(this)" class="nav-link">
          <i class="fas fa-info-circle"></i> Sobre
        </a>
        <a href="#contato" onclick="showSection('contato'); setActiveLink(this)" class="nav-link">
          <i class="fas fa-envelope"></i> Contato
        </a>
      </nav>
      
      <div class="user-section">
        <div class="cart-info" onclick="showCartModal()">
          <i class="fas fa-shopping-cart"></i>
          <span class="cart-count" id="cart-count">0</span>
        </div>
        
        <div class="user-info">
          <i class="fas fa-user"></i>
          <span id="user-name">Visitante</span>
        </div>
        
        <a href="login.html" class="btn-login" id="login-btn">
          <i class="fas fa-sign-in-alt"></i> Login
        </a>
      </div>
    </div>
  </header>

  <main>
    <!-- Se√ß√£o In√≠cio -->
    <section id="inicio" class="section active">
      <!-- Banner Principal -->
      <div class="hero-banner">
        <div class="banner-content">
          <h2>Bem-vindo √† Nossa Loja!</h2>
          <p>Descubra produtos incr√≠veis com os melhores pre√ßos</p>
          <button onclick="showSection('produtos')" class="btn-primary">Ver Produtos</button>
        </div>
        <div class="banner-image">
          <img src="https://via.placeholder.com/600x300/4CAF50/ffffff?text=Ofertas+Especiais" alt="Banner principal">
        </div>
      </div>

      <!-- Produtos em Destaque -->
      <div class="featured-section">
        <h2>‚ú® Produtos em Destaque</h2>
        <div class="featured-products" id="featured-products">
          <!-- Produtos em destaque ser√£o carregados aqui -->
        </div>
      </div>

      <!-- Categorias em Destaque -->
      <div class="categories-preview">
        <h2>üè∑Ô∏è Nossas Categorias</h2>
        <div class="categories-grid" id="home-categories">
          <!-- Categorias ser√£o carregadas aqui -->
        </div>
      </div>

      <!-- Ofertas Especiais -->
      <div class="offers-section">
        <h2>üî• Ofertas Especiais</h2>
        <div class="offers-banner">
          <div class="offer-card">
            <h3>Frete Gr√°tis</h3>
            <p>Em compras acima de R$ 99,00</p>
          </div>
          <div class="offer-card">
            <h3>Primeira Compra</h3>
            <p>10% de desconto para novos clientes</p>
          </div>
          <div class="offer-card">
            <h3>Entrega R√°pida</h3>
            <p>Receba em at√© 2 dias √∫teis</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Se√ß√£o Produtos -->
    <section id="produtos" class="section">
      <div class="section-header">
        <h2>üõçÔ∏è Todos os Produtos</h2>
        <div class="filters">
          <select id="category-filter">
            <option value="">Todas as Categorias</option>
            <option value="roupas">Roupas</option>
            <option value="calcados">Cal√ßados</option>
            <option value="acessorios">Acess√≥rios</option>
            <option value="eletronicos">Eletr√¥nicos</option>
          </select>
          <select id="price-filter">
            <option value="">Qualquer Pre√ßo</option>
            <option value="0-50">At√© R$ 50</option>
            <option value="50-100">R$ 50 - R$ 100</option>
            <option value="100-200">R$ 100 - R$ 200</option>
            <option value="200+">Acima de R$ 200</option>
          </select>
          <button onclick="applyFilters()" class="btn-secondary">Filtrar</button>
        </div>
      </div>
      
      <div class="products-grid" id="all-products">
        <!-- Todos os produtos ser√£o carregados aqui -->
      </div>
    </section>

    <!-- Se√ß√£o Categorias -->
    <section id="categorias" class="section">
      <h2>üìÇ Nossas Categorias</h2>
      <div class="categories-detailed" id="detailed-categories">
        <!-- Categorias detalhadas ser√£o carregadas aqui -->
      </div>
    </section>

    <!-- Se√ß√£o Sobre -->
    <section id="sobre" class="section">
      <div class="about-content">
        <h2>Sobre a Minha Loja</h2>
        <div class="about-grid">
          <div class="about-text">
            <h3>Nossa Hist√≥ria</h3>
            <p>A Minha Loja nasceu com o objetivo de oferecer produtos de qualidade com os melhores pre√ßos do mercado. Nossa miss√£o √© proporcionar uma experi√™ncia de compra √∫nica e satisfat√≥ria para nossos clientes.</p>
            
            <h3>Nossos Valores</h3>
            <ul>
              <li>‚úÖ Qualidade garantida em todos os produtos</li>
              <li>‚úÖ Atendimento personalizado e humanizado</li>
              <li>‚úÖ Entrega r√°pida e segura</li>
              <li>‚úÖ Pre√ßos justos e competitivos</li>
              <li>‚úÖ Satisfa√ß√£o total do cliente</li>
            </ul>
          </div>
          <div class="about-stats">
            <div class="stat-item">
              <h3 id="total-products-public">0</h3>
              <p>Produtos Dispon√≠veis</p>
            </div>
            <div class="stat-item">
              <h3 id="total-customers">0</h3>
              <p>Clientes Satisfeitos</p>
            </div>
            <div class="stat-item">
              <h3>5‚≠ê</h3>
              <p>Avalia√ß√£o M√©dia</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Se√ß√£o Contato -->
    <section id="contato" class="section">
      <div class="contact-content">
        <h2>üí¨ Entre em Contato</h2>
        <div class="contact-grid">
          <div class="contact-info">
            <h3>Informa√ß√µes de Contato</h3>
            <div class="contact-item">
              <strong>üìç Endere√ßo:</strong>
              <p>Rua das Flores, 123 - Centro<br>S√£o Paulo - SP, 01234-567</p>
            </div>
            <div class="contact-item">
              <strong>üìû Telefone:</strong>
              <p>(11) 9999-8888</p>
            </div>
            <div class="contact-item">
              <strong>üìß Email:</strong>
              <p>contato@minhaloja.com</p>
            </div>
            <div class="contact-item">
              <strong>üïí Hor√°rio de Funcionamento:</strong>
              <p>Segunda a Sexta: 9h √†s 18h<br>S√°bado: 9h √†s 14h</p>
            </div>
          </div>
          
          <div class="contact-form">
            <h3>Envie uma Mensagem</h3>
            <form id="contact-form">
              <div class="form-group">
                <input type="text" placeholder="Seu Nome" required>
              </div>
              <div class="form-group">
                <input type="email" placeholder="Seu Email" required>
              </div>
              <div class="form-group">
                <input type="text" placeholder="Assunto" required>
              </div>
              <div class="form-group">
                <textarea placeholder="Sua Mensagem" rows="5" required></textarea>
              </div>
              <button type="submit" class="btn-primary">Enviar Mensagem</button>
            </form>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Modal do Produto -->
  <div id="product-modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeProductModal()">&times;</span>
      <div id="product-details">
        <!-- Detalhes do produto ser√£o carregados aqui -->
      </div>
    </div>
  </div>

  <!-- Modal do Carrinho -->
  <div id="cart-modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeCartModal()">&times;</span>
      <h2>üõí Seu Carrinho</h2>
      <div id="cart-items-modal">
        <!-- Itens do carrinho ser√£o carregados aqui -->
      </div>
      <div class="cart-footer">
        <div class="cart-total">
          <strong>Total: R$ <span id="cart-total-modal">0.00</span></strong>
        </div>
        <div class="cart-actions">
          <button onclick="goToLogin()" class="btn-primary">Finalizar Compra</button>
          <button onclick="clearCart()" class="btn-secondary">Limpar Carrinho</button>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3>Minha Loja</h3>
        <p>Sua loja online de confian√ßa com produtos de qualidade e os melhores pre√ßos.</p>
      </div>
      
      <div class="footer-section">
        <h3>Links √öteis</h3>
        <ul>
          <li><a href="#produtos" onclick="showSection('produtos')">Produtos</a></li>
          <li><a href="#sobre" onclick="showSection('sobre')">Sobre</a></li>
          <li><a href="#contato" onclick="showSection('contato')">Contato</a></li>
          <li><a href="login.html">√Årea do Cliente</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h3>Atendimento</h3>
        <p>üìû (11) 9999-8888</p>
        <p>üìß contato@minhaloja.com</p>
        <p>üïí Seg-Sex: 9h-18h</p>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; <span id="ano"></span> Minha Loja. Todos os direitos reservados.</p>
    </div>
  </footer>

  <script type="module">
    import authManager from './auth-manager.js';
    import productManager from './product-manager.js';
    
    // Inicializa√ß√£o da p√°gina
    document.addEventListener('DOMContentLoaded', function() {
      // Inicializar gerenciador de autentica√ß√£o
      if (window.authManager) {
        authManager.updateUI();
      }
      
      // Inicializar contadores do carrinho
      if (window.productManager) {
        productManager.updateCartUI();
      }
      
      // Definir ano no footer
      document.getElementById('ano').textContent = new Date().getFullYear();
      
      // Mostrar se√ß√£o inicial
      showSection('inicio');
      
      // Configurar evento de busca (se existir)
      setupSearchEvents();
    });
    
    // Fun√ß√£o para mostrar se√ß√µes
    function showSection(sectionName) {
      // Ocultar todas as se√ß√µes
      document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
      });
      
      // Mostrar se√ß√£o selecionada
      const targetSection = document.getElementById(sectionName);
      if (targetSection) {
        targetSection.classList.add('active');
      }
      
      // Scroll suave para o topo
      window.scrollTo({
        top: 0,
        behavior: 'smooth'
      });
      
      // A√ß√µes espec√≠ficas por se√ß√£o
      switch(sectionName) {
        case 'produtos':
          if (window.productManager) {
            productManager.renderProducts();
          }
          break;
        case 'inicio':
          if (window.productManager) {
            // Carregar produtos em destaque
            productManager.loadFeaturedProducts();
          }
          break;
      }
    }
    
    // Fun√ß√£o para definir link ativo
    function setActiveLink(clickedLink) {
      // Remover classe ativa de todos os links
      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active');
      });
      
      // Adicionar classe ativa ao link clicado
      clickedLink.classList.add('active');
    }
    
    // Fun√ß√£o para configurar eventos de busca
    function setupSearchEvents() {
      const searchInput = document.getElementById('header-search');
      const searchButton = document.querySelector('.search-btn');
      
      if (searchInput && searchButton) {
        const performSearch = () => {
          const searchTerm = searchInput.value.trim();
          if (searchTerm && window.productManager) {
            productManager.filterProducts({ search: searchTerm });
            showSection('produtos');
          }
        };
        
        searchButton.addEventListener('click', performSearch);
        searchInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter') {
            e.preventDefault();
            performSearch();
          }
        });
      }
    }
    
    // Modal do carrinho
    function showCartModal() {
      if (!window.productManager) {
        console.error('Product Manager n√£o est√° dispon√≠vel');
        return;
      }
      
      const cart = productManager.getCart();
      
      const modal = document.createElement('div');
      modal.className = 'modal cart-modal';
      modal.innerHTML = `
        <div class="modal-content large">
          <div class="modal-header">
            <h2><i class="fas fa-shopping-cart"></i> Seu Carrinho</h2>
            <span class="close">&times;</span>
          </div>
          <div class="cart-content">
            ${cart.length === 0 ? 
              '<div class="empty-cart"><i class="fas fa-shopping-cart"></i><p>Seu carrinho est√° vazio</p></div>' :
              cart.map(item => `
                <div class="cart-item-modal" data-id="${item.id}">
                  <img src="${item.imagem || 'https://via.placeholder.com/60x60?text=Produto'}" alt="${item.nome}">
                  <div class="item-info">
                    <h4>${item.nome}</h4>
                    <p class="item-price">R$ ${item.preco.toFixed(2)} cada</p>
                  </div>
                  <div class="quantity-controls">
                    <button class="qty-btn minus" onclick="updateCartQuantity('${item.id}', ${item.quantity - 1})">
                      <i class="fas fa-minus"></i>
                    </button>
                    <span class="quantity">${item.quantity}</span>
                    <button class="qty-btn plus" onclick="updateCartQuantity('${item.id}', ${item.quantity + 1})">
                      <i class="fas fa-plus"></i>
                    </button>
                  </div>
                  <div class="item-total">R$ ${(item.preco * item.quantity).toFixed(2)}</div>
                  <button class="btn-remove" onclick="removeFromCart('${item.id}')" title="Remover item">
                    <i class="fas fa-trash"></i>
                  </button>
                </div>
              `).join('')
            }
          </div>
          ${cart.length > 0 ? `
            <div class="cart-footer">
              <div class="cart-summary">
                <div class="cart-total">
                  <strong>Total: R$ ${cart.reduce((sum, item) => sum + (item.preco * item.quantity), 0).toFixed(2)}</strong>
                </div>
                <div class="cart-items-count">${cart.reduce((sum, item) => sum + item.quantity, 0)} item(s)</div>
              </div>
              <div class="cart-actions">
                <button class="btn-secondary" onclick="clearCart()">
                  <i class="fas fa-trash"></i> Limpar Carrinho
                </button>
                <button class="btn-primary" onclick="proceedToCheckout()">
                  <i class="fas fa-credit-card"></i> Finalizar Compra
                </button>
              </div>
            </div>
          ` : `
            <div class="cart-footer">
              <button class="btn-primary" onclick="showSection('produtos'); closeCartModal()">
                <i class="fas fa-shopping-bag"></i> Ver Produtos
              </button>
            </div>
          `}
        </div>
      `;
      
      document.body.appendChild(modal);
      modal.style.display = 'block';
      
      // Adicionar anima√ß√£o de entrada
      setTimeout(() => {
        modal.classList.add('show');
      }, 10);
      
      // Fechar modal
      modal.querySelector('.close').addEventListener('click', () => {
        closeCartModal();
      });
      
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          closeCartModal();
        }
      });
      
      // Fun√ß√£o para fechar modal
      window.closeCartModal = function() {
        modal.classList.remove('show');
        setTimeout(() => {
          if (modal.parentNode) {
            document.body.removeChild(modal);
          }
        }, 300);
      };
    }
    
    // Fun√ß√µes globais para o carrinho
    window.updateCartQuantity = function(productId, newQuantity) {
      if (newQuantity <= 0) {
        removeFromCart(productId);
        return;
      }
      
      if (window.productManager) {
        const cartItem = productManager.cart.find(item => item.id === productId);
        if (cartItem) {
          cartItem.quantity = newQuantity;
          productManager.saveCart();
          productManager.updateCartUI();
          
          // Atualizar display do modal
          const cartItemElement = document.querySelector(`[data-id="${productId}"]`);
          if (cartItemElement) {
            cartItemElement.querySelector('.quantity').textContent = newQuantity;
            cartItemElement.querySelector('.item-total').textContent = 
              `R$ ${(cartItem.preco * newQuantity).toFixed(2)}`;
            
            // Atualizar total
            updateCartTotals();
          }
        }
      }
    };
    
    window.removeFromCart = function(productId) {
      if (window.productManager) {
        productManager.cart = productManager.cart.filter(item => item.id !== productId);
        productManager.saveCart();
        productManager.updateCartUI();
        
        // Reabrir modal atualizado
        closeCartModal();
        setTimeout(() => showCartModal(), 100);
      }
    };
    
    window.clearCart = function() {
      if (window.productManager) {
        productManager.clearCart();
        if (window.authManager) {
          authManager.showSuccess('Carrinho limpo com sucesso!');
        }
        closeCartModal();
      }
    };
    
    window.proceedToCheckout = function() {
      if (!window.authManager || !authManager.isAuthenticated) {
        if (window.authManager) {
          authManager.showError('Fa√ßa login para finalizar a compra');
        }
        setTimeout(() => {
          window.location.href = 'login.html';
        }, 2000);
        return;
      }
      
      // Redirecionar para √°rea do cliente
      window.location.href = 'client.html#checkout';
    };
    
    function updateCartTotals() {
      if (!window.productManager) return;
      
      const cart = productManager.getCart();
      const total = cart.reduce((sum, item) => sum + (item.preco * item.quantity), 0);
      const itemCount = cart.reduce((sum, item) => sum + item.quantity, 0);
      
      const totalElement = document.querySelector('.cart-total strong');
      const countElement = document.querySelector('.cart-items-count');
      
      if (totalElement) {
        totalElement.textContent = `Total: R$ ${total.toFixed(2)}`;
      }
      
      if (countElement) {
        countElement.textContent = `${itemCount} item(s)`;
      }
    }
    
    // Fun√ß√µes globais compat√≠veis com o HTML existente
    window.showSection = showSection;
    window.setActiveLink = setActiveLink;
    window.showCartModal = showCartModal;
    
    // Fun√ß√£o para mostrar se√ß√µes
    function showSection(sectionName) {
      // Ocultar todas as se√ß√µes
      document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
      });
      
      // Mapear nomes de se√ß√£o
      const sectionMap = {
        'inicio': 'home',
        'produtos': 'featured-section',
        'sobre': 'about',
        'contato': 'contact'
      };
      
      const targetSectionId = sectionMap[sectionName] || sectionName;
      const targetSection = document.getElementById(targetSectionId) || document.querySelector(`.${targetSectionId}`);
      
      if (targetSection) {
        targetSection.classList.add('active');
      }
      
      // A√ß√µes espec√≠ficas por se√ß√£o
      switch(sectionName) {
        case 'produtos':
          productManager.renderProducts();
          break;
        case 'inicio':
          // Mostrar produtos em destaque
          productManager.filterProducts({ category: '' });
          break;
      }
    }
    
    // Modal do carrinho
    function showCartModal() {
      const cart = productManager.getCart();
      
      const modal = document.createElement('div');
      modal.className = 'modal';
      modal.innerHTML = `
        <div class="modal-content large">
          <span class="close">&times;</span>
          <h2><i class="fas fa-shopping-cart"></i> Seu Carrinho</h2>
          <div class="cart-content">
            ${cart.length === 0 ? 
              '<div class="empty-cart">Seu carrinho est√° vazio</div>' :
              cart.map(item => `
                <div class="cart-item-modal">
                  <img src="${item.imagem || 'https://via.placeholder.com/60x60?text=Produto'}" alt="${item.nome}">
                  <div class="item-info">
                    <h4>${item.nome}</h4>
                    <p>R$ ${item.preco.toFixed(2)} cada</p>
                  </div>
                  <div class="quantity-controls">
                    <button onclick="updateCartQuantity('${item.id}', ${item.quantity - 1})">-</button>
                    <span>${item.quantity}</span>
                    <button onclick="updateCartQuantity('${item.id}', ${item.quantity + 1})">+</button>
                  </div>
                  <div class="item-total">R$ ${(item.preco * item.quantity).toFixed(2)}</div>
                  <button class="btn-remove" onclick="removeFromCart('${item.id}')">&times;</button>
                </div>
              `).join('')
            }
          </div>
          ${cart.length > 0 ? `
            <div class="cart-footer">
              <div class="cart-total">
                <strong>Total: R$ ${cart.reduce((sum, item) => sum + (item.preco * item.quantity), 0).toFixed(2)}</strong>
              </div>
              <div class="cart-actions">
                <button class="btn-secondary" onclick="productManager.clearCart(); closeCartModal();">
                  <i class="fas fa-trash"></i> Limpar Carrinho
                </button>
                <button class="btn-primary" onclick="proceedToCheckout()">
                  <i class="fas fa-credit-card"></i> Finalizar Compra
                </button>
              </div>
            </div>
          ` : ''}
        </div>
      `;
      
      document.body.appendChild(modal);
      modal.style.display = 'block';
      
      // Fechar modal
      modal.querySelector('.close').addEventListener('click', () => {
        document.body.removeChild(modal);
      });
      
      modal.addEventListener('click', (e) => {
        if (e.target === modal) {
          document.body.removeChild(modal);
        }
      });
      
      // Definir fun√ß√µes globais para o modal
      window.updateCartQuantity = function(productId, newQuantity) {
        if (newQuantity <= 0) {
          removeFromCart(productId);
          return;
        }
        
        const cartItem = productManager.cart.find(item => item.id === productId);
        if (cartItem) {
          cartItem.quantity = newQuantity;
          productManager.saveCart();
          productManager.updateCartUI();
          
          // Reabrir modal atualizado
          document.body.removeChild(modal);
          showCartModal();
        }
      };
      
      window.removeFromCart = function(productId) {
        productManager.cart = productManager.cart.filter(item => item.id !== productId);
        productManager.saveCart();
        productManager.updateCartUI();
        
        // Reabrir modal atualizado
        document.body.removeChild(modal);
        showCartModal();
      };
      
      window.closeCartModal = function() {
        document.body.removeChild(modal);
      };
      
      window.proceedToCheckout = function() {
        if (!authManager.isAuthenticated) {
          authManager.showError('Fa√ßa login para finalizar a compra');
          setTimeout(() => {
            window.location.href = 'login.html';
          }, 2000);
          return;
        }
        
        // Redirecionar para √°rea do cliente
        window.location.href = 'client.html#checkout';
      };
    }
    
    // Fun√ß√µes globais compat√≠veis com o HTML existente
    window.showSection = showSection;
    window.showCartModal = showCartModal;
    window.showAllCategories = function(event) {
      event.preventDefault();
      productManager.filterProducts({ category: '' });
      showSection('produtos');
    };
    window.filterByCategory = function(category, event) {
      event.preventDefault();
      productManager.filterProducts({ category: category });
      showSection('produtos');
    };
    window.searchProducts = function() {
      const searchInput = document.getElementById('header-search');
      const searchTerm = searchInput.value.trim();
      if (searchTerm) {
        productManager.filterProducts({ search: searchTerm });
        showSection('produtos');
      }
    };
    window.goToLogin = function() {
      window.location.href = 'login.html';
    };
    window.clearCart = function() {
      productManager.clearCart();
      authManager.showSuccess('Carrinho limpo com sucesso!');
    };
  </script>
</body>
</html>